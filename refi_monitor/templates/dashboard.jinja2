{% extends "main_layout.jinja2" %}

{% block pagecontent %}
<div class="ml-72 p-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-8">Refinance Monitor Dashboard</h1>

    {% if mortgage_alerts|length < 1 %}
    {# Empty state - no mortgages #}
    <div class="max-w-md">
        <a href="{{url_for('mortgage_bp.addmortgage')}}">
            <div class="bg-gradient-to-r from-green-900 to-green-800 shadow-lg rounded-lg hover:shadow-xl transition-shadow">
                <div class="p-7">
                    <h2 class="text-xl text-center text-gray-200">Click to Add a Mortgage</h2>
                    <h3 class="text-sm text-gray-400 text-center mt-2">Welcome to Refinance Monitor!</h3>
                </div>
            </div>
        </a>
    </div>
    {% else %}
    {# Mortgage cards grid #}
    <div class="space-y-8">
        {% for ma in mortgage_alerts %}
        {% set mortgage = ma[0] %}
        {% set alert = ma[1] %}
        {% set status_graph = ma[2] %}
        {% set time_graph = ma[3] %}
        {% set break_even = ma[4] %}

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            {# MortgageCard Component #}
            <div class="lg:col-span-1">
                {% include 'components/mortgage_card.jinja2' %}
            </div>

            {# Graphs Section #}
            <div class="lg:col-span-1 space-y-4">
                {% if status_graph %}
                <div class="bg-gray-800 rounded-lg shadow-lg p-4">
                    {{ status_graph|safe }}
                </div>
                {% endif %}
                {% if time_graph %}
                <div class="bg-gray-800 rounded-lg shadow-lg p-4">
                    {{ time_graph|safe }}
                </div>
                {% endif %}
            </div>
        </div>

        {# Divider between mortgages #}
        {% if not loop.last %}
        <div class="border-t border-green-600 my-8"></div>
        {% endif %}
        {% endfor %}

        {# Add another mortgage button #}
        <div class="mt-8">
            <a href="{{url_for('mortgage_bp.addmortgage')}}"
               class="inline-flex items-center px-4 py-2 text-sm font-medium text-green-300 bg-green-900/50 border border-green-700 rounded-md hover:bg-green-800/50 transition-colors">
                <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                </svg>
                Add Another Mortgage
            </a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
