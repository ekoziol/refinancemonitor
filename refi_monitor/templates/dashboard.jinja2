{% extends "main_layout.jinja2" %}

{% block pagecontent %}
<b><h1 class="text-4xl text-center text-gray-800">Refinance Monitor Dashboard</h1></b>

<table class="ml-72 mt-16">

{% if mortgage_alerts|length < 1 %}
<tr>
    <td>
        <a href="{{url_for('mortgage_bp.addmortgage')}}">
            <div class="bg-gradient-to-r flex-auto w-42 h-42  from-green-900 to-green-800    shadow-lg    rounded-lg">
                    <div class="md:p-7 p-4">
                        <h2 class="text-xl text-center text-gray-200 capitalize">Click to Add a Mortgage</h2>
                        <h3 class="text-sm  text-gray-400  text-center">Welcome to Refinance Monitor!</h3>
                    </div>
                </div>
        </a>
    </td>
</tr>
{% else %}
    {% for ma in mortgage_alerts %}
    {% set m = ma[0] %}
    {% set a = ma[1] %}
    {% set status_graph = ma[2] %}
    {% set time_graph = ma[3] %}
    {% set rate_history_graph = ma[4] %}
    <tr>
        <tr>
            <td>
                <table>
    <!--                 <tr>
                        <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                                <div class="md:p-7 p-4">
                                    <h2 class="text-xl text-center text-gray-200 capitalize">{{ m.name }}</h2>
                                    <h3 class="text-sm  text-gray-400  text-center">Mortgage Name</h3>
                                </div>
                        </div>
                    </tr> -->
                    <tr>
     <!--                    <td><b>Remaining Principal: </b></td><td>${{ m.remaining_principal }}</td> -->
                        <td>
                            <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                                    <div class="md:p-7 p-4">
                                        <h2 class="text-xl text-center text-gray-200 capitalize">{{ m.name }}</h2>
                                        <h3 class="text-sm  text-gray-400  text-center">Mortgage Name</h3>
                                    </div>
                            </div>
                        </td>
                        <td>
                        <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                            <div class="md:p-7 p-4">
                                <h2 class="text-xl text-center text-gray-200 capitalize">{{ "${:,.0f}".format(m.remaining_principal) }}</h2>
                                <h3 class="text-sm  text-gray-400  text-center">Remaining Principal</h3>
                            </div>
                        </div>
                        </td>
                        
                        <td>
                            <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                                <div class="md:p-7 p-4">
                                    <h2 class="text-xl text-center text-gray-200 capitalize">{{ m.remaining_term|string + " months" }}</h2>
                                    <h3 class="text-sm  text-gray-400  text-center">Remaining Term</h3>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
            <td>
                <table>
                {% if a is not none %}

                        <td>
                            <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                                <div class="md:p-7 p-4">
                                    <h2 class="text-xl text-center text-gray-200 capitalize">{{ a.alert_type }}</h2>
                                    <h3 class="text-sm  text-gray-400  text-center">Alert Type</h3>
                                </div>
                            </div>
                        </td>
                {% if a.alert_type == "Monthly Payment" %}
                    <td>
                        <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                            <div class="md:p-7 p-4">
                                <h2 class="text-xl text-center text-gray-200 capitalize">${{ a.target_monthly_payment }}</h2>
                                <h3 class="text-sm  text-gray-400  text-center">Target Monthly Payment</h3>
                            </div>
                        </div>
                    </td>
                {% elif a.alert_type == "Interest Rate" %}
                    <td>
                        <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                            <div class="md:p-7 p-4">
                                <h2 class="text-xl text-center text-gray-200 capitalize">{{ a.target_interest_rate }}%</h2>
                                <h3 class="text-sm  text-gray-400  text-center">Target Interest Rate:</h3>
                            </div>
                        </div>
                    </td>
              {% endif %}
                    <td>
                        <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                            <div class="md:p-7 p-4">
                                <h2 class="text-xl text-center text-gray-200 capitalize">${{ a.target_monthly_payment }}</h2>
                                <h3 class="text-sm  text-gray-400  text-center">Trigger Status</h3>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="bg-gradient-to-r flex-auto w-42 h-42  from-gray-800 to-gray-700    shadow-lg    rounded-lg">
                            <div class="md:p-7 p-4">
                                <h2 class="text-xl text-center text-gray-200 capitalize">${{ a.target_monthly_payment }}</h2>
                                <h3 class="text-sm  text-gray-400  text-center">Last Trigger Date</h3>
                            </div>
                        </div>
                    </td>
              {% else %}
                    <a href="{{url_for('mortgage_bp.addalert', m_id=m.id)}}">
                    <div class="bg-gradient-to-r flex-auto w-42 h-42  from-green-900 to-green-800    shadow-lg    rounded-lg">
                            <div class="md:p-7 p-4">
                                <h2 class="text-xl text-center text-gray-200 capitalize">+ Click to set an alert</h2>
                                <h3 class="text-sm  text-gray-400  text-center">No Alerts Found</h3>
                            </div>
                        </div>
                    </a>

              {% endif %}
                </table>
            </td>
        </tr>
        <tr>
            <td>
            {% if status_graph %}
                {{ status_graph|safe }}
            {% endif %}
            </td>
            <td>
            {% if time_graph %}
                {{ time_graph|safe }}
            {% endif %}
            </td>
        </tr>
        <tr>
            <td colspan="2" class="pt-4">
                <div class="bg-gradient-to-r from-gray-800 to-gray-700 shadow-lg rounded-lg p-4">
                    <h3 class="text-lg text-gray-200 mb-2">Rate History for {{ m.zip_code }}</h3>
                    {% if rate_history_graph %}
                        {{ rate_history_graph|safe }}
                    {% endif %}
                </div>
            </td>
        </tr>
    </tr>
    <tr>
        <td class="bg-green-600 h-0.5" colspan="2"></td>
    </tr>
    {% endfor %}
    {% endif %}

    </table>
{% endblock %}